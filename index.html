<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Google Takvim Etkinlikleri</title>
</head>
<body>
  <h1>Takvim Etkinlikleri</h1>
  <button onclick="handleAuthClick()">Google ile Giriş Yap</button>
  <button onclick="listUpcomingEvents()">Etkinlikleri Göster</button>
  <ul id="event-list"></ul>

  <script src="https://apis.google.com/js/api.js"></script>
  <script>
    const CLIENT_ID = '270944409412-g5p51bra8t2cedq1h3mrdobd4dtm871o.apps.googleusercontent.com'; // Google Cloud'dan al
    const API_KEY = 'AIzaSyCh7KY4994qjiSXHkfgFTudCCgb67_gMd4'; // Google Cloud'dan al
    const DISCOVERY_DOCS = ["https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest"];
    const SCOPES = "https://www.googleapis.com/auth/calendar.readonly";

    function handleClientLoad() {
      gapi.load('client:auth2', initClient);
    }

    function initClient() {
      gapi.client.init({
        apiKey: API_KEY,
        clientId: CLIENT_ID,
        discoveryDocs: DISCOVERY_DOCS,
        scope: SCOPES
      });
    }

    function handleAuthClick() {
      gapi.auth2.getAuthInstance().signIn();
    }

    function listUpcomingEvents() {
      gapi.client.calendar.events.list({
        'calendarId': 'primary',
        'timeMin': (new Date()).toISOString(),
        'showDeleted': false,
        'singleEvents': true,
        'maxResults': 50,
        'orderBy': 'startTime'
      }).then(function(response) {
        const events = response.result.items;
        const listEl = document.getElementById('event-list');
        listEl.innerHTML = '';

        if (events.length > 0) {
          events.forEach(event => {
            const li = document.createElement('li');
            const when = event.start.dateTime || event.start.date;
            li.textContent = `${when} - ${event.summary}`;
            listEl.appendChild(li);
          });
        } else {
          listEl.innerHTML = '<li>Hiç etkinlik bulunamadı.</li>';
        }
      });
    }

    // Sayfa yüklenince client'i yükle
    handleClientLoad();
  </script>
</body>
</html>
